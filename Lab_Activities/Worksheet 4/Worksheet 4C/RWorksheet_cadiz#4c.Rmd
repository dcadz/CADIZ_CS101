---
title: "RWorksheet_cadiz#4c"
author: "John Dave R. Cadiz"
date: "2024-11-03"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Use the dataset mpg

## a. Show your solutions on hpw to import a csv file into the environment
```{r}
library(ggplot2)

mpgdata <- read.csv("mpg.csv")
str(mpgdata)
```
## b. Which varialbles from mpg data are categorical?
```{r}
# The categorical variables from the mpg data set are manufacture, model, year,
# cyl, trans, drv, fl, and class.
```
## c. Which are continouse variables?
```{r}
# The continious variable from the data set mpr are displ, cty, and hwy.
```

## 2. Which manufacturer has the most models in this data set? Which model has
## has the most variations? Show your answer?

## a. Group the manufacturers and find the unique model. Show your codes and result.
```{r}
library(dplyr)
manufacturer_model <- mpg %>%
  group_by(manufacturer) %>%
  summarize(model_num = n_distinct(model)) %>%
  arrange(desc(model_num))

manufacturer_model

variations_num <- table(mpg$model)
variations_num [variations_num == max(variations_num)]
```
## b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}
manufacturer_data <- setNames(
  manufacturer_model$model_num, 
  manufacturer_model$manufacturer
  )

barplot(manufacturer_data, 
        main = "Number of Models per Manufacturer",
        xlab = "Manufacturer",
        ylab = "Number of Models",
        col = c("pink", "purple", "skyblue", "grey", "orchid"),
        las = 3)

variations_num <- mpg %>%
  group_by(model) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

variations_num

ggplot(variations_num,
       aes(x = reorder(model, -count), y = count)) +
       geom_bar(stat = "identity", fill = "pink") +
       labs(title = "Number of Variations per Model", x = "Model", y = "Count") +
       theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
## 2. Same dataset will be used. You are going to show the relationship between the model and the manufacturer.

## a. What does ggplot(mpg,aes(model, manufacturer)) + geom_point() show?
```{r}
ggplot(mpg,aes(model, manufacturer)) + geom_point()

# this snippet shows the code of a scatter plot by two data named models and manufacturers.
```
## b. For you, is it useful? If not, how could you modify the data to make it more informative?
```{r}
# For me, it could be better to not use the scatter plot in this type of visualization because it is difficult to track and interpret the given data. I will modify it and change to bar graph, by this I could show the difference between each models and manufacturer by using the labels and specific colors in this way it can help me to track and interpret the data without error.
```
## 3.Plot the mdoel and the year using ggplot(). Use only the top 20 observations. Write the codes and its results.
```{r}
topobservation <- mpg[1:20, ]

ggplot(topobservation, 
       aes(x = model, y = year)) +
       geom_point(color = "purple", size = 2) +
       labs(
          title = "Model and Year (Top 20 Observations)",
          x = "Model",
          y = "Year") +
       theme(axis.text.x = element_text(angle = 90, hjust = 1))
```



